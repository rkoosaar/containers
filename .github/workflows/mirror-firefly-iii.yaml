name: Mirror Firefly III to GHCR

on:
  # schedule:
  #   - cron: "0 3 * * *" # daily
  workflow_dispatch:

jobs:
  mirror:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write   # <— REQUIRED for GHCR push
    steps:
      - name: Mirror core → GHCR (multi-arch)
        uses: redhat-actions/skopeo-copy@v2
        with:
          src: docker://docker.io/fireflyiii/core:latest
          dest: docker://ghcr.io/${{ github.repository_owner }}/firefly-iii:latest
          dest-username: ${{ github.actor }}
          dest-password: ${{ secrets.GITHUB_TOKEN }}
          multi-arch: true
